# port: 53

Notes
# """##These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n #{RHOST} -d #{Domain_Name}
dnsrecon -r 127.0.1.0/24 -n #{RHOST} -d #{Domain_Name}
dnsrecon -r #{Network}#{CIDR} -n #{RHOST} -d #{Domain_Name}
dig axfr @#{RHOST}
dig axfr #{Domain_Name} @#{RHOST}
nslookup
    SERVER #{RHOST}
    127.0.0.1
    #{RHOST}
    Domain_Name
    exit

https://book.hacktricks.xyz/pentesting/pentesting-dns
"""

# Grab DNS Banner
# desc:Banner Grab
dig version.bind CHAOS TXT @DNS

# Scan for Vulnerabilities with Nmap
# desc:Nmap Vuln Scan
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" #{RHOST}

# Three attempts at forcing a zone transfer
# desc:Zone Transfer
dig axfr @#{RHOST} && dix axfr @#{RHOST} #{Domain_Name} && fierce -dns #{Domain_Name}

# Eunuerate a DC via DNS
# desc:Active Directory
dig -t _gc._#{Domain_Name} && dig -t _ldap._#{Domain_Name} && dig -t _kerberos._#{Domain_Name} && dig -t _kpasswd._#{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain=#{Domain_Name}"

