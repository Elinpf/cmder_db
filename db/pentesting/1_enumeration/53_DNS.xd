# port: 53

# desc: [INFO]
Notes
# """##These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n #{RHOST} -d #{DOMAIN}
dnsrecon -r 127.0.1.0/24 -n #{RHOST} -d #{DOMAIN}
dnsrecon -r #{Network}#{CIDR} -n #{RHOST} -d #{DOMAIN}
dig axfr @#{RHOST}
dig axfr #{DOMAIN} @#{RHOST}
nslookup
    SERVER #{RHOST}
    127.0.0.1
    #{RHOST}
    Domain_Name
    exit

https://book.hacktricks.xyz/pentesting/pentesting-dns
"""

# Grab DNS Banner
# desc:Banner Grab
dig version.bind CHAOS TXT @DNS

# Scan for Vulnerabilities with Nmap
# desc:Nmap Vuln Scan
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" #{RHOST}

# Three attempts at forcing a zone transfer
# desc:Zone Transfer
dig axfr @#{RHOST} && dix axfr @#{RHOST} #{DOMAIN} && fierce -dns #{DOMAIN}

# Eunuerate a DC via DNS
# desc:Active Directory
dig -t _gc._#{DOMAIN} && dig -t _ldap._#{DOMAIN} && dig -t _kerberos._#{DOMAIN} && dig -t _kpasswd._#{DOMAIN} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain=#{DOMAIN}"

